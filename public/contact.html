<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>The Den — Contact Us</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800;900&display=swap" rel="stylesheet">

  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    :root {
      --bg-dark: #050507;
      --bg-gradient: radial-gradient(circle at top, #1b1b22 0%, #000 100%);
      --text-main: #ffffff;
      --text-muted: rgba(255, 255, 255, 0.7);
      --accent: #ef4444; 
      --glass: rgba(255, 255, 255, 0.05);
      --glass-border: rgba(255, 255, 255, 0.1);
      --font-body: 'Inter', system-ui, -apple-system, sans-serif;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    html, body { 
      width: 100%; max-width: 100%; overflow-x: hidden;
      background: var(--bg-gradient);
      color: var(--text-main);
      font-family: var(--font-body);
      line-height: 1.6;
      padding-top: 80px;
    }

    .container { max-width: 1100px; margin: 0 auto; padding: 0 20px; }
    
    .btn {
      display: inline-flex; align-items: center; justify-content: center; gap: 8px;
      background: var(--accent); color: white;
      padding: 12px 24px; border-radius: 99px;
      font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em;
      text-decoration: none; font-size: 11px; border: none; cursor: pointer;
      transition: 0.2s; white-space: nowrap; 
      width: auto;
    }
    .btn:hover { opacity: 0.9; transform: translateY(-1px); }
    
    .btn-outline {
      background: transparent; border: 1px solid var(--glass-border); color: var(--text-muted);
    }
    .btn-outline:hover { border-color: white; color: white; }

    .section-title {
      font-size: 12px; color: var(--accent); letter-spacing: 0.2em;
      text-transform: uppercase; font-weight: 800; margin-bottom: 10px; display: block;
    }
    h2 { font-size: 32px; font-weight: 800; line-height: 1.1; margin-bottom: 20px; }

    header {
      position: fixed; top: 0; width: 100%; z-index: 100;
      background: rgba(0,0,0,0.9); backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--glass-border);
    }
    .nav-wrap { display: flex; justify-content: space-between; align-items: center; height: 70px; }
    
    /* Logo Styles */
    .logo { 
      font-weight: 900; font-size: 20px; text-transform: uppercase; 
      letter-spacing: 0.1em; font-style: italic; text-decoration: none; color: white;
    }
    .logo span { color: var(--accent); }
    
    .nav-links { display: flex; gap: 24px; }
    .nav-links a { color: var(--text-muted); text-decoration: none; font-size: 13px; font-weight: 500; text-transform: uppercase; }
    .nav-links a:hover, .nav-links a.active { color: white; }
    
    .mobile-toggle { display: none; cursor: pointer; color: white; }
    
    @media(max-width: 768px) { 
      .nav-links { 
        display: none; 
        position: absolute; top: 70px; left: 0; width: 100%;
        background: #000; flex-direction: column; padding: 20px; border-bottom: 1px solid var(--glass-border);
      }
      .nav-links.open { display: flex; }
      .mobile-toggle { display: block; }
    }

    .contact-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 60px; margin-top: 40px; }
    @media(max-width: 768px) { .contact-grid { grid-template-columns: 1fr; gap: 40px; } }

    .contact-item { display: flex; align-items: flex-start; gap: 16px; margin-bottom: 24px; }
    .contact-icon { color: var(--accent); margin-top: 2px; width: 18px; height: 18px; flex: 0 0 18px; }

    .map-container {
      width: 100%; height: 400px; border-radius: 12px; overflow: hidden;
      border: 1px solid var(--glass-border); position: relative;
      filter: grayscale(100%) invert(88%) brightness(95%) contrast(105%);
    }

    .hours-card { background: var(--glass); border: 1px solid var(--glass-border); padding: 30px; border-radius: 12px; margin-top: 30px; }
    .hour-row { display: flex; justify-content: space-between; border-bottom: 1px solid var(--glass-border); padding: 10px 0; font-size: 14px; }
    .hour-row:last-child { border: none; }

    footer { border-top: 1px solid var(--glass-border); padding: 40px 0; margin-top: 60px; text-align: center; color: var(--text-muted); font-size: 12px; }
  </style>
</head>
<body>

  <div id="nsdBusiness" data-business-id="" style="display:none"></div>

  <header>
    <div class="container nav-wrap">
      <a href="index.html#home" class="logo" id="header_logo">THE <span>DEN</span></a>
      
      <div class="mobile-toggle" onclick="toggleMenu()">
        <i data-lucide="menu"></i>
      </div>

      <nav class="nav-links" id="navLinks">
        <a href="index.html">Home</a>
        <a href="about.html">About</a>
        <a href="services.html">Services</a>
        <a href="gallery.html">Gallery</a>
        <a href="contact.html" class="active">Contact</a>
      </nav>
      
      <a href="javascript:void(0)" class="btn header-btn" onclick="openBooking(); return false;">Book Now</a>
    </div>
  </header>

  <main class="container">
    <div class="contact-grid">
      <div>
        <span class="section-title">Get In Touch</span>
        <h2>Stop By The Shop</h2>
        <p style="color:var(--text-muted); margin-bottom: 40px;">
          Got a question about a cut? Looking for a specific barber? Drop us a line or pull up to the shop.
        </p>

        <div style="margin-bottom: 40px;">
          <div class="contact-item">
            <i data-lucide="map-pin" class="contact-icon"></i>
            <div>
              <strong style="display:block; margin-bottom:4px;">Location</strong>
              <span style="color:var(--text-muted); font-size:14px;">3904 Bainbridge Blvd<br>Chesapeake, VA 23324</span>
            </div>
          </div>
          <div class="contact-item">
            <i data-lucide="phone" class="contact-icon"></i>
            <div>
              <strong style="display:block; margin-bottom:4px;">Phone</strong>
              <a href="tel:7575432966" style="color:var(--text-muted); font-size:14px; text-decoration: none;">(757) 543-2966</a>
            </div>
          </div>
        </div>

        <div style="display:flex; flex-direction:column; gap:14px; margin-top:10px;">
          <a href="tel:7575432966" class="btn" style="width:100%">Call The Shop</a>
          <a href="sms:+17575432966" class="btn btn-outline" style="width:100%">Text Us</a>
          <button type="button" class="btn btn-outline" onclick="openBooking(); return false;" style="width:100%">Book An Appointment</button>
          <p style="color:var(--text-muted); font-size:12px; text-align:center; margin-top:10px;">
            Fastest response is call or text. Walk-ins welcome.
          </p>
        </div>

      </div>

      <div>
        <div class="map-container">
          <iframe 
            title="Google Maps Location for The Den Barbershop"
            loading="lazy"
            style="border:0; display:block;" 
            allowfullscreen="" 
            width="100%" 
            height="100%" 
            referrerpolicy="no-referrer-when-downgrade"
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3195.404561021464!2d-76.28919632367566!3d36.78453486851628!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89ba980f7a0a0a0d%3A0x1234567890abcdef!2s3904%20Bainbridge%20Blvd%2C%20Chesapeake%2C%20VA%2023324!5e0!3m2!1sen!2sus!4v1700000000000!5m2!1sen!2sus">
          </iframe>
        </div>

        <div class="hours-card">
          <h3 style="font-size:16px; text-transform:uppercase; letter-spacing:0.1em; margin-bottom:20px; color:white;">Shop Hours</h3>
          <div id="hours_list">
            <div style="color:var(--text-muted); font-size:13px;">Loading hours...</div>
          </div>
        </div>

      </div>
    </div>
  </main>

  <footer>
    <div class="container">
      <div style="font-weight:900; font-size:24px; margin-bottom:10px; text-transform:uppercase; font-style:italic;">THE <span style="color:var(--accent)">DEN</span></div>
      <p>© 2026 The Den Barbershop. Powered by Net Studio.</p>
    </div>
  </footer>

  <script>
    lucide.createIcons();
    
    function toggleMenu() {
      const nav = document.getElementById('navLinks');
      nav.classList.toggle('open');
    }

    window.openBooking = window.openBooking || function () { console.warn("Booking script not yet loaded."); };
    window.closeBooking = window.closeBooking || function () { console.warn("Booking script not yet loaded."); };
  </script>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  
  <script>
    function nsGetSlugFromHost() {
      const qp = new URLSearchParams(location.search).get("b");
      if (qp) return qp.toLowerCase();
      const host = location.hostname.toLowerCase();
      if (host.endsWith(".netstudio.app")) return host.split(".")[0];
      return null; // or fallback
    }

    window.NS = window.NS || {
      SUPABASE_URL: "https://jdvdgvolfmvlgyfklbwe.supabase.co",
      SUPABASE_ANON_KEY: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpkdmRndm9sZm12bGd5ZmtsYndlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM1Mjk5MDgsImV4cCI6MjA3OTEwNTkwOH0.xiAOgWof9En3jbCpY1vrYpj3HD-O6jMHbamIHTSflek",
      BUSINESS_SLUG: nsGetSlugFromHost()
    };

    const sb = supabase.createClient(NS.SUPABASE_URL, NS.SUPABASE_ANON_KEY);

    function nsDayOrder(d){
      const m = { monday: 1, tuesday: 2, wednesday: 3, thursday: 4, friday: 5, saturday: 6, sunday: 7 };
      return m[String(d || "").toLowerCase()] || 99;
    }

    function nsFmtTime(t){
      if (!t) return "";
      const parts = String(t).split(":");
      const hh = parseInt(parts[0] || "0", 10);
      const mm = parts[1] || "00";
      const ampm = hh >= 12 ? "PM" : "AM";
      const h12 = ((hh + 11) % 12) + 1;
      return `${h12}:${mm} ${ampm}`;
    }

    function nsDayLabel(d){
      const x = String(d || "").toLowerCase();
      return x ? x.charAt(0).toUpperCase() + x.slice(1) : "";
    }

    function renderHoursFromRows(rows){
      const el = document.getElementById("hours_list");
      if (!el || !rows || !rows.length) {
        if (el) el.innerHTML = `<div style="color:rgba(255,255,255,0.4)">Hours not available</div>`;
        return;
      }

      const sorted = [...rows].sort((a,b) => nsDayOrder(a.day_of_week) - nsDayOrder(b.day_of_week));

      el.innerHTML = sorted.map(r => {
        const day = nsDayLabel(r.day_of_week);
        const closed = !!r.is_closed || !r.open_time || !r.close_time;
        const time = closed ? "Closed" : `${nsFmtTime(r.open_time)} - ${nsFmtTime(r.close_time)}`;

        return `
          <div class="hour-row">
            <span style="color:${closed ? "var(--accent)" : "var(--text-muted)"}">
              ${day}
            </span>
            <span ${closed ? `style="color:var(--accent); font-weight:700"` : ""}>
              ${time}
            </span>
          </div>
        `;
      }).join("");
    }

    async function loadHours(businessId){
      // ✅ Using verified column names from your DB (is_closed instead of is_open)
      const { data, error } = await sb
        .from("business_hours")
        .select("day_of_week, open_time, close_time, is_closed")
        .eq("business_id", businessId);

      return (error) ? null : data;
    }

    (async () => {
      try {
        if (!NS.BUSINESS_SLUG) {
           console.warn("No slug found");
           return;
        }

        const { data: biz, error } = await sb
          .from("business")
          .select("id")
          .eq("slug", NS.BUSINESS_SLUG)
          .maybeSingle();

        if (error || !biz?.id) return;

        document.getElementById("nsdBusiness")?.setAttribute("data-business-id", biz.id);
        document.body.dataset.businessId = biz.id;

        const hours = await loadHours(biz.id);
        renderHoursFromRows(hours || []);

      } catch (e) {
        console.error("Hours load failed:", e);
      }
    })();
  </script>
  <script src="/assets/js/netstudio_booking.js"></script>

</body>
</html>
